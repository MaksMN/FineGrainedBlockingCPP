# Итоговое задание 29.7

**Задача**

Напишите реализацию метода `insertIntoMiddle(int value, int pos)` для списка мелкогранулярной блокировкой. Часть кода уже написана — сама структура списка взята из юнита про мелкогранулярную блокировку и приведена ниже.
```cpp
struct Node
{
  int value;
  Node* next;
  std::mutex* node_mutex;
};

class FineGrainedQueue
{
  Node* head;
  std::mutex* queue_mutex;
};
```
Функция должна вставить узел с переданным значением value в позицию pos. Чтобы не переусложнять реализацию, предполагается следующее:

 - очередь не пустая,
 - вставляется элемент в середину или конец списка, то есть вставку в начало списка не нужно рассматривать,
 - если pos больше длины списка, то нужно вставить элемент в конец списка.

**Реализация**

Метод `insertIntoMiddle(int value, int pos)` реализован в файле FineGrainedQueue.cpp
Блокировка мелкогранулярная, блокируются только модифицируемые узлы, остальные улы списка не блокируются.

В main.cpp имитированы ситуации которые могут вызвать гонки данных. Вставка в одну и ту же позицию из нескольких потоков. Удаление + вставка в одной и той же позиции из разных потоков. Вставка из разных потоков в позицию большую чем длинна списка. Все эти операции завершаются корректно с ожидаемым результатом, без взаимоблокировок и гонки данных.